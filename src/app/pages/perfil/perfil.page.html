<app-navegacion>
  <ion-content>

    <div *ngIf="usuario && usuario.rol == 'usuario'; else comprobarVendedor" class="perfil-container">

      <div class="info-usuario">
        <h2 class="perfil-titulo">Mi Perfil</h2>

        <div class="info-item">
          <label class="info-label">Correo Electrónico</label>
          <div class="info-card">
            <ion-icon name="mail-outline" class="info-icon"></ion-icon> <!-- correcto -->
            <p class="info-text">{{ usuario.email }}</p>
          </div>
        </div>

        <div class="info-item">
          <label class="info-label">Nombre de Usuario</label>
          <div class="info-card">
            <ion-icon name="person-circle-outline" class="info-icon"></ion-icon> <!-- más distintivo para perfil -->
            <p class="info-text">{{ usuario.nombre }}</p>
          </div>
        </div>
      </div>

      <div class="acciones">
        <ion-button expand="block" class="accion-btn" fill="outline" [routerLink]="['/cambio-clave']">
          <ion-icon name="lock-closed-outline" slot="start"></ion-icon> <!-- icono de candado más común -->
          Cambiar Contraseña
        </ion-button>

        <ion-button expand="block" class="accion-btn" fill="outline" [routerLink]="['/cambio-nombre-usuario']">
          <ion-icon name="pencil-outline" slot="start"></ion-icon> <!-- lápiz más usado para editar -->
          Cambiar Nombre de Usuario
        </ion-button>

        <ion-button expand="block" class="accion-btn" fill="outline" [routerLink]="['/historial-compra']">
          <ion-icon name="receipt-outline" slot="start"></ion-icon> <!-- icono de recibo para historial de compras -->
          Historial de Compras
        </ion-button>

        <ion-button expand="block" class="accion-btn" fill="outline" [routerLink]="['/mis-solicitudes-de-soporte']">
          <ion-icon name="help-circle-outline" slot="start"></ion-icon>
          Mis solicitudes de soporte
        </ion-button>

        <ion-button expand="block" class="accion-btn" fill="outline" [routerLink]="['/usuario-vendedor']">
          <ion-icon name="storefront-outline" slot="start"></ion-icon> <!-- icono tienda para convertirse en vendedor -->
          Transformarte en vendedor
        </ion-button>

        <ion-button expand="block" class="accion-btn cerrar-sesion-btn" fill="solid" color="danger" (click)="cerrarSesion()">
          <ion-icon name="log-out-outline" slot="start"></ion-icon> <!-- versión outline para mantener consistencia -->
          Cerrar Sesión
        </ion-button>
      </div>

    </div>

    <ng-template #comprobarVendedor>
      <div *ngIf="usuario && usuario.rol == 'usuario-vendedor'; else invitado" class="perfil-container">
        <div class="perfil-header">
          <ion-avatar class="avatar">
            <img [src]=" usuario.imagen " alt="Foto de perfil vendedor">
          </ion-avatar>
          <h2>{{ usuario.nombre }}</h2>
          <p>{{ usuario.email }}</p>
        </div>

        <div class="perfil-opciones">

          <ion-button expand="block" fill="outline" routerLink="/cambio-clave">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            Cambiar Contraseña
          </ion-button>

          <ion-button expand="block" fill="outline" routerLink="/cambio-nombre-usuario">
            <ion-icon name="pencil-outline" slot="start"></ion-icon>
            Cambiar Nombre de Usuario
          </ion-button>

          <ion-button expand="block" fill="outline" routerLink="/historial-ventas">
            <ion-icon name="bag-check-outline" slot="start"></ion-icon> <!-- icono bolsa para ventas -->
            Historial de Ventas
          </ion-button>

          <ion-button expand="block" class="accion-btn" fill="outline" [routerLink]="['/historial-compra']">
            <ion-icon name="receipt-outline" slot="start"></ion-icon>
            Historial de Compras
          </ion-button>

          <ion-button expand="block" fill="outline" routerLink="/mis-productos">
            <ion-icon name="cube-outline" slot="start"></ion-icon> <!-- producto -->
            Mis Productos
          </ion-button>

          <ion-button *ngIf="usuario.membresia" expand="block" fill="outline" routerLink="/prediccion-ventas">
            <ion-icon name="trending-up-outline" slot="start"></ion-icon> <!-- gráfico tendencia -->
            Ver prediccion de ventas
          </ion-button>

          <ion-button *ngIf="!usuario.membresia" expand="block" fill="outline" (click)="estadoBotonPaypal()">
            <ion-icon name="trending-up-outline" slot="start"></ion-icon>
            Ver prediccion de ventas
          </ion-button>
          
          <div *ngIf="mostrarBotonPaypal" class="boton-paypal" style="display: block;">
            <div class="pagar">
              <div class="total-desglose">
                <div class="total-final">Miembro 1 año ${{ this.costoMembresia | number }} CLP</div>
                <ion-button *ngIf="!mostrarBotonPaypal" expand="block" color="tertiary" (click)="estadoBotonPaypal()">Obtener membresia</ion-button>
              </div>
                <div id="paypal-button-container"></div>
              </div>
          </div>
          
          <ion-button expand="block" color="danger" (click)="cerrarSesion()">
            <ion-icon name="log-out-outline" slot="start"></ion-icon>
            Cerrar Sesión
          </ion-button>

        </div>

      </div>
    </ng-template>

    <ng-template #invitado>
      <div class="invitado-container">
        <h2>¡Bienvenido!</h2>
        <p>¿Aún no tienes cuenta o ya tienes una? Elige una opción:</p>
        <ion-button expand="block" fill="solid" [routerLink]="['/registro']">
          <ion-icon name="person-add-outline" slot="start"></ion-icon>
          Registrarse
        </ion-button>
    
        <ion-button expand="block" fill="solid" [routerLink]="['/ingreso']">
          <ion-icon name="log-in-outline" slot="start"></ion-icon>
          Ingresar
        </ion-button>
      </div>
    </ng-template>

  </ion-content>
</app-navegacion>
